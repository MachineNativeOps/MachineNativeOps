name: ğŸš€ CI Pipeline
true:
  pull_request:
    branches:
    - main
    - develop
    types:
    - opened
    - synchronize
    - reopened
  push:
    branches:
    - main
    - develop
concurrency:
  cancel-in-progress: ${{ github.event_name == 'pull_request' }}
  group: ${{ github.workflow }}-${{ github.ref }}
permissions:
  checks: write
  contents: read
  packages: write
  pull-requests: write
env:
  DOCKER_REGISTRY: ghcr.io
  GO_VERSION: '1.21'
  IMAGE_NAME: machinenativeops
  JAVA_VERSION: '17'
  NODE_VERSION: '20'
  PYTHON_VERSION: '3.11'
jobs:
  ci-summary:
    if: always()
    name: ğŸ“‹ CI Summary Report
    needs:
    - code-quality
    - security-scan
    - unit-tests
    - integration-tests
    runs-on: ubuntu-latest
    steps:
    - name: ä¸‹è¼‰æ‰€æœ‰å ±å‘Š
      uses: actions/download-artifact@v4
      with:
        merge-multiple: true
    - name: ç”ŸæˆCIç¸½çµå ±å‘Š
      run: "echo \"# \U0001F680 CI Pipeline Summary Report\" > ci-summary-report.md\n\
        echo \"\" >> ci-summary-report.md\necho \"**ç”Ÿæˆæ™‚é–“**: $(date)\" >> ci-summary-report.md\n\
        echo \"**åˆ†æ”¯**: ${{ github.ref_name }}\" >> ci-summary-report.md\necho \"**æäº¤**:\
        \ ${{ github.sha }}\" >> ci-summary-report.md\necho \"**PR**: #${{ github.event.pull_request.number\
        \ || 'N/A' }}\" >> ci-summary-report.md\necho \"\" >> ci-summary-report.md\n\
        \necho \"## \U0001F4CA Pipeline ç‹€æ…‹\" >> ci-summary-report.md\necho \"- \U0001F50D\
        \ ä»£ç¢¼å“è³ªæª¢æŸ¥: ${{ needs.code-quality.result }}\" >> ci-summary-report.md\necho\
        \ \"- \U0001F512 å®‰å…¨æƒæ: ${{ needs.security-scan.result }}\" >> ci-summary-report.md\n\
        echo \"- \U0001F9EA å–®å…ƒæ¸¬è©¦: ${{ needs.unit-tests.result }}\" >> ci-summary-report.md\n\
        echo \"- \U0001F517 é›†æˆæ¸¬è©¦: ${{ needs.integration-tests.result }}\" >> ci-summary-report.md\n\
        echo \"\" >> ci-summary-report.md\n\n# åˆ¤æ–·æ•´é«”ç‹€æ…‹\nif [ \"${{ needs.code-quality.result\
        \ }}\" = \"success\" ] && \\\n   [ \"${{ needs.security-scan.result }}\" =\
        \ \"success\" ] && \\\n   [ \"${{ needs.unit-tests.result }}\" = \"success\"\
        \ ] && \\\n   [ \"${{ needs.integration-tests.result }}\" = \"success\" ];\
        \ then\n  echo \"## âœ… æ•´é«”ç‹€æ…‹: é€šé\" >> ci-summary-report.md\n  echo \"\U0001F389\
        \ æ‰€æœ‰ CI æª¢æŸ¥éƒ½å·²é€šéï¼\" >> ci-summary-report.md\nelse\n  echo \"## âŒ æ•´é«”ç‹€æ…‹: å¤±æ•—\"\
        \ >> ci-summary-report.md\n  echo \"âš ï¸ éƒ¨åˆ† CI æª¢æŸ¥å¤±æ•—ï¼Œè«‹æŸ¥çœ‹è©³ç´°å ±å‘Šã€‚\" >> ci-summary-report.md\n\
        fi\n\necho \"\" >> ci-summary-report.md\necho \"## \U0001F4CB è©³ç´°å ±å‘Š\" >> ci-summary-report.md\n\
        echo \"- [ä»£ç¢¼å“è³ªå ±å‘Š](code-quality-report.md)\" >> ci-summary-report.md\necho\
        \ \"- [å®‰å…¨æƒæå ±å‘Š](security-report.md)\" >> ci-summary-report.md\necho \"- [å–®å…ƒæ¸¬è©¦å ±å‘Š](test-report.md)\"\
        \ >> ci-summary-report.md\necho \"- [é›†æˆæ¸¬è©¦å ±å‘Š](integration-test-report.md)\"\
        \ >> ci-summary-report.md\n\ncat ci-summary-report.md\n"
    - if: failure() && github.event_name == 'pull_request'
      name: è©•è«–PRï¼ˆå¦‚æœæœ‰å¤±æ•—ï¼‰
      uses: actions/github-script@v7
      with:
        script: "const fs = require('fs');\n\nif (fs.existsSync('ci-summary-report.md'))\
          \ {\n  const report = fs.readFileSync('ci-summary-report.md', 'utf8');\n\
          \  \n  github.rest.issues.createComment({\n    issue_number: context.issue.number,\n\
          \    owner: context.repo.owner,\n    repo: context.repo.repo,\n    body:\
          \ report\n  });\n}\n"
    - name: ä¸Šå‚³ç¸½çµå ±å‘Š
      uses: actions/upload-artifact@v4
      with:
        name: ci-summary-report
        path: ci-summary-report.md
        retention-days: 30
  code-quality:
    name: ğŸ” Code Quality Analysis
    runs-on: ubuntu-latest
    steps:
    - name: æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
    - name: è¨­ç½® Python ç’°å¢ƒ
      uses: actions/setup-python@v5
      with:
        cache: pip
        python-version: ${{ env.PYTHON_VERSION }}
    - name: è¨­ç½® Node.js ç’°å¢ƒ
      uses: actions/setup-node@v4
      with:
        cache: npm
        node-version: ${{ env.NODE_VERSION }}
    - name: å®‰è£ä»£ç¢¼å“è³ªå·¥å…·
      run: 'pip install --user pylint black flake8 mypy bandit safety

        npm install -g eslint prettier @typescript-eslint/parser

        '
    - name: Python ä»£ç¢¼æª¢æŸ¥
      run: "echo \"\U0001F50D åŸ·è¡Œ Python ä»£ç¢¼å“è³ªæª¢æŸ¥...\"\nfind . -name \"*.py\" -type f\
        \ ! -path \"*/node_modules/*\" ! -path \"*/.git/*\" > python_files.txt\n\n\
        if [ -s python_files.txt ]; then\n  echo \"\U0001F4CA ç™¼ç¾ $(wc -l < python_files.txt)\
        \ å€‹ Python æ–‡ä»¶\"\n  \n  # Pylint æª¢æŸ¥\n  echo \"\U0001F50D åŸ·è¡Œ Pylint æª¢æŸ¥...\"\n\
        \  pylint --disable=C0114,C0115,C0116 --score=no $(cat python_files.txt) ||\
        \ true\n  \n  # Black æ ¼å¼æª¢æŸ¥\n  echo \"\U0001F3A8 æª¢æŸ¥ä»£ç¢¼æ ¼å¼...\"\n  black --check\
        \ --diff $(cat python_files.txt) || echo \"âš ï¸ Black æª¢æŸ¥ç™¼ç¾æ ¼å¼å•é¡Œ\"\n  \n  # Flake8\
        \ æª¢æŸ¥\n  echo \"\U0001F50D åŸ·è¡Œ Flake8 æª¢æŸ¥...\"\n  flake8 --max-line-length=100\
        \ --ignore=E203,W503 $(cat python_files.txt) || true\n  \n  # MyPy é¡å‹æª¢æŸ¥\n\
        \  echo \"\U0001F50D åŸ·è¡Œ MyPy é¡å‹æª¢æŸ¥...\"\n  mypy --ignore-missing-imports --no-strict-optional\
        \ $(cat python_files.txt) || true\nelse\n  echo \"â„¹ï¸ æœªç™¼ç¾ Python æ–‡ä»¶\"\nfi\n"
    - name: JavaScript/TypeScript ä»£ç¢¼æª¢æŸ¥
      run: "echo \"\U0001F50D åŸ·è¡Œ JavaScript/TypeScript ä»£ç¢¼å“è³ªæª¢æŸ¥...\"\nfind . -name \"\
        *.js\" -o -name \"*.ts\" -o -name \"*.jsx\" -o -name \"*.tsx\" | grep -v node_modules\
        \ > js_files.txt\n\nif [ -s js_files.txt ]; then\n  echo \"\U0001F4CA ç™¼ç¾ $(wc\
        \ -l < js_files.txt) å€‹ JS/TS æ–‡ä»¶\"\n  \n  # ESLint æª¢æŸ¥\n  echo \"\U0001F50D\
        \ åŸ·è¡Œ ESLint æª¢æŸ¥...\"\n  eslint $(cat js_files.txt) || echo \"âš ï¸ ESLint æª¢æŸ¥ç™¼ç¾å•é¡Œ\"\
        \n  \n  # Prettier æ ¼å¼æª¢æŸ¥\n  echo \"\U0001F3A8 æª¢æŸ¥ä»£ç¢¼æ ¼å¼...\"\n  prettier --check\
        \ $(cat js_files.txt) || echo \"âš ï¸ Prettier æª¢æŸ¥ç™¼ç¾æ ¼å¼å•é¡Œ\"\nelse\n  echo \"â„¹ï¸\
        \ æœªç™¼ç¾ JavaScript/TypeScript æ–‡ä»¶\"\nfi\n"
    - name: ç”Ÿæˆä»£ç¢¼å“è³ªå ±å‘Š
      run: 'echo "# ğŸ“Š Code Quality Report" > code-quality-report.md

        echo "" >> code-quality-report.md

        echo "**æª¢æŸ¥æ™‚é–“**: $(date)" >> code-quality-report.md

        echo "**æäº¤**: ${{ github.sha }}" >> code-quality-report.md

        echo "" >> code-quality-report.md


        # çµ±è¨ˆæ–‡ä»¶æ•¸é‡

        PY_COUNT=$(find . -name "*.py" -type f ! -path "*/node_modules/*" | wc -l)

        JS_COUNT=$(find . -name "*.js" -o -name "*.ts" -o -name "*.jsx" -o -name "*.tsx"
        | grep -v node_modules | wc -l)


        echo "## ğŸ“ˆ ä»£ç¢¼çµ±è¨ˆ" >> code-quality-report.md

        echo "- Python æ–‡ä»¶: $PY_COUNT" >> code-quality-report.md

        echo "- JavaScript/TypeScript æ–‡ä»¶: $JS_COUNT" >> code-quality-report.md

        echo "" >> code-quality-report.md


        echo "## ğŸ” æª¢æŸ¥çµæœ" >> code-quality-report.md

        echo "âœ… ä»£ç¢¼å“è³ªæª¢æŸ¥å·²å®Œæˆ" >> code-quality-report.md


        cat code-quality-report.md

        '
    - name: ä¸Šå‚³å“è³ªå ±å‘Š
      uses: actions/upload-artifact@v4
      with:
        name: code-quality-report
        path: code-quality-report.md
        retention-days: 30
    timeout-minutes: 20
  integration-tests:
    name: ğŸ”— Integration Tests
    needs:
    - code-quality
    - security-scan
    runs-on: ubuntu-latest
    services:
      postgres:
        env:
          POSTGRES_DB: testdb
          POSTGRES_PASSWORD: testpass
        image: postgres:15
        options: --health-cmd pg_isready --health-interval 10s --health-timeout 5s
          --health-retries 5
        ports:
        - 5432:5432
      redis:
        image: redis:7
        options: --health-cmd "redis-cli ping" --health-interval 10s --health-timeout
          5s --health-retries 5
        ports:
        - 6379:6379
    steps:
    - name: æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v4
    - name: è¨­ç½® Python ç’°å¢ƒ
      uses: actions/setup-python@v5
      with:
        python-version: ${{ env.PYTHON_VERSION }}
    - name: å®‰è£é›†æˆæ¸¬è©¦ä¾è³´
      run: 'pip install --user pytest docker-compose requests

        '
    - name: åŸ·è¡Œé›†æˆæ¸¬è©¦
      run: "echo \"\U0001F517 åŸ·è¡Œé›†æˆæ¸¬è©¦...\"\n\n# è¨­ç½®æ¸¬è©¦ç’°å¢ƒè®Šé‡\nexport DATABASE_URL=\"postgresql://postgres:testpass@localhost:5432/testdb\"\
        \nexport REDIS_URL=\"redis://localhost:6379\"\nexport TEST_ENV=\"integration\"\
        \n\n# æŸ¥æ‰¾é›†æˆæ¸¬è©¦æ–‡ä»¶\nfind . -name \"*integration*\" -name \"test_*.py\" -o -name\
        \ \"*integration*\" -name \"*_test.py\" > integration_test_files.txt\n\nif\
        \ [ -s integration_test_files.txt ]; then\n  echo \"\U0001F4CA ç™¼ç¾ $(wc -l\
        \ < integration_test_files.txt) å€‹é›†æˆæ¸¬è©¦æ–‡ä»¶\"\n  \n  # åŸ·è¡Œé›†æˆæ¸¬è©¦\n  pytest \\\n \
        \   --verbose \\\n    --tb=short \\\n    --junit-xml=integration-test-results.xml\
        \ \\\n    $(dirname $(head -1 integration_test_files.txt)) || echo \"âš ï¸ éƒ¨åˆ†é›†æˆæ¸¬è©¦å¤±æ•—\"\
        \nelse\n  echo \"â„¹ï¸ æœªç™¼ç¾é›†æˆæ¸¬è©¦æ–‡ä»¶\"\nfi\n"
    - if: always()
      name: ç”Ÿæˆé›†æˆæ¸¬è©¦å ±å‘Š
      run: "echo \"# \U0001F517 Integration Test Report\" > integration-test-report.md\n\
        echo \"\" >> integration-test-report.md\necho \"**æ¸¬è©¦æ™‚é–“**: $(date)\" >> integration-test-report.md\n\
        echo \"**æäº¤**: ${{ github.sha }}\" >> integration-test-report.md\necho \"\"\
        \ >> integration-test-report.md\n\nif [ -f \"integration-test-results.xml\"\
        \ ]; then\n  echo \"## \U0001F517 é›†æˆæ¸¬è©¦çµ±è¨ˆ\" >> integration-test-report.md\n\
        \  # è§£æ JUnit XML çµ±è¨ˆä¿¡æ¯\n  TESTS=$(grep -o 'tests=\"[0-9]*\"' integration-test-results.xml\
        \ | head -1 | cut -d'\"' -f2 || echo \"0\")\n  FAILURES=$(grep -o 'failures=\"\
        [0-9]*\"' integration-test-results.xml | head -1 | cut -d'\"' -f2 || echo\
        \ \"0\")\n  ERRORS=$(grep -o 'errors=\"[0-9]*\"' integration-test-results.xml\
        \ | head -1 | cut -d'\"' -f2 || echo \"0\")\n  \n  echo \"- ç¸½æ¸¬è©¦æ•¸: $TESTS\"\
        \ >> integration-test-report.md\n  echo \"- å¤±æ•—æ•¸: $FAILURES\" >> integration-test-report.md\n\
        \  echo \"- éŒ¯èª¤æ•¸: $ERRORS\" >> integration-test-report.md\n  \n  if [ \"$FAILURES\"\
        \ = \"0\" ] && [ \"$ERRORS\" = \"0\" ]; then\n    echo \"- ç‹€æ…‹: âœ… å…¨éƒ¨é€šé\" >>\
        \ integration-test-report.md\n  else\n    echo \"- ç‹€æ…‹: âŒ éƒ¨åˆ†å¤±æ•—\" >> integration-test-report.md\n\
        \  fi\nelse\n  echo \"â„¹ï¸ æœªç”Ÿæˆé›†æˆæ¸¬è©¦çµæœæ–‡ä»¶\" >> integration-test-report.md\nfi\n\
        \ncat integration-test-report.md\n"
    - if: always()
      name: ä¸Šå‚³é›†æˆæ¸¬è©¦å ±å‘Š
      uses: actions/upload-artifact@v4
      with:
        name: integration-test-results
        path: 'integration-test-report.md

          integration-test-results.xml

          '
        retention-days: 30
    timeout-minutes: 45
  security-scan:
    name: ğŸ”’ Security Vulnerability Scan
    runs-on: ubuntu-latest
    steps:
    - name: æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v4
    - name: è¨­ç½® Python ç’°å¢ƒ
      uses: actions/setup-python@v5
      with:
        python-version: ${{ env.PYTHON_VERSION }}
    - name: å®‰è£å®‰å…¨æƒæå·¥å…·
      run: 'pip install --user safety bandit semgrep

        npm install -g audit-ci snyk

        '
    - name: Python ä¾è³´å®‰å…¨æƒæ
      run: "echo \"\U0001F512 æƒæ Python ä¾è³´æ¼æ´...\"\nfind . -name \"requirements.txt\"\
        \ -o -name \"setup.py\" -o -name \"pyproject.toml\" | grep -v node_modules\
        \ > requirements_files.txt\n\nif [ -s requirements_files.txt ]; then\n  for\
        \ req_file in $(cat requirements_files.txt); do\n    echo \"\U0001F4CB æª¢æŸ¥æ–‡ä»¶:\
        \ $req_file\"\n    if [ -f \"$req_file\" ]; then\n      safety check -r \"\
        $req_file\" --json --output safety-report.json || echo \"âš ï¸ Safety ç™¼ç¾æ½›åœ¨å•é¡Œ\"\
        \n    fi\n  done\nelse\n  echo \"â„¹ï¸ æœªç™¼ç¾ Python ä¾è³´æ–‡ä»¶\"\nfi\n"
    - name: Python ä»£ç¢¼å®‰å…¨æƒæ
      run: "echo \"\U0001F50D åŸ·è¡Œ Bandit å®‰å…¨æƒæ...\"\nfind . -name \"*.py\" -type f !\
        \ -path \"*/node_modules/*\" ! -path \"*/.git/*\" > python_files.txt\n\nif\
        \ [ -s python_files.txt ]; then\n  bandit -r $(dirname $(head -1 python_files.txt))\
        \ -f json -o bandit-report.json || echo \"âš ï¸ Bandit ç™¼ç¾æ½›åœ¨å®‰å…¨å•é¡Œ\"\nfi\n"
    - name: Semgrep ä»£ç¢¼åˆ†æ
      run: 'echo "ğŸ” åŸ·è¡Œ Semgrep ä»£ç¢¼åˆ†æ..."

        semgrep --config=auto --json --output=semgrep-report.json . || echo "âš ï¸ Semgrep
        åˆ†æå®Œæˆ"

        '
    - name: Node.js ä¾è³´å®‰å…¨æƒæ
      run: "echo \"\U0001F512 æƒæ Node.js ä¾è³´æ¼æ´...\"\nfind . -name \"package.json\"\
        \ | grep -v node_modules > package_files.txt\n\nif [ -s package_files.txt\
        \ ]; then\n  for pkg_file in $(cat package_files.txt); do\n    pkg_dir=$(dirname\
        \ \"$pkg_file\")\n    echo \"\U0001F4CB æª¢æŸ¥ç›®éŒ„: $pkg_dir\"\n    cd \"$pkg_dir\"\
        \n    npm audit --audit-level moderate --json > ../npm-audit-report.json ||\
        \ echo \"âš ï¸ npm audit ç™¼ç¾å•é¡Œ\"\n    cd - > /dev/null\n  done\nelse\n  echo \"\
        â„¹ï¸ æœªç™¼ç¾ Node.js ä¾è³´æ–‡ä»¶\"\nfi\n"
    - name: ç”Ÿæˆå®‰å…¨å ±å‘Š
      run: 'echo "# ğŸ”’ Security Scan Report" > security-report.md

        echo "" >> security-report.md

        echo "**æƒææ™‚é–“**: $(date)" >> security-report.md

        echo "**æäº¤**: ${{ github.sha }}" >> security-report.md

        echo "" >> security-report.md


        echo "## ğŸ›¡ï¸ å®‰å…¨æƒæçµæœ" >> security-report.md

        echo "âœ… å®‰å…¨æƒæå·²å®Œæˆ" >> security-report.md

        echo "" >> security-report.md


        echo "### ğŸ“‹ æƒæé …ç›®" >> security-report.md

        echo "- Python ä¾è³´æ¼æ´æƒæ (Safety)" >> security-report.md

        echo "- Python ä»£ç¢¼å®‰å…¨æƒæ (Bandit)" >> security-report.md

        echo "- ä»£ç¢¼éœæ…‹åˆ†æ (Semgrep)" >> security-report.md

        echo "- Node.js ä¾è³´æƒæ (npm audit)" >> security-report.md


        cat security-report.md

        '
    - name: ä¸Šå‚³å®‰å…¨å ±å‘Š
      uses: actions/upload-artifact@v4
      with:
        name: security-scan-report
        path: 'security-report.md

          safety-report.json

          bandit-report.json

          semgrep-report.json

          npm-audit-report.json

          '
        retention-days: 30
    timeout-minutes: 15
  unit-tests:
    name: ğŸ§ª Unit Tests
    runs-on: ubuntu-latest
    steps:
    - name: æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v4
    - name: è¨­ç½® Python ${{ matrix.python-version }}
      uses: actions/setup-python@v5
      with:
        cache: pip
        python-version: ${{ matrix.python-version }}
    - name: å®‰è£æ¸¬è©¦ä¾è³´
      run: 'pip install --user pytest pytest-cov pytest-xdist pytest-mock coverage

        '
    - name: åŸ·è¡Œå–®å…ƒæ¸¬è©¦
      run: "echo \"\U0001F9EA åŸ·è¡Œ Python å–®å…ƒæ¸¬è©¦...\"\n\n# æŸ¥æ‰¾æ¸¬è©¦æ–‡ä»¶\nfind . -name \"test_*.py\"\
        \ -o -name \"*_test.py\" ! -path \"*/node_modules/*\" > test_files.txt\n\n\
        if [ -s test_files.txt ]; then\n  echo \"\U0001F4CA ç™¼ç¾ $(wc -l < test_files.txt)\
        \ å€‹æ¸¬è©¦æ–‡ä»¶\"\n  \n  # åŸ·è¡Œæ¸¬è©¦ä¸¦ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š\n  pytest \\\n    --verbose \\\n    --tb=short\
        \ \\\n    --cov=. \\\n    --cov-report=xml \\\n    --cov-report=html \\\n\
        \    --cov-report=term-missing \\\n    --junit-xml=test-results.xml \\\n \
        \   $(dirname $(head -1 test_files.txt)) || echo \"âš ï¸ éƒ¨åˆ†æ¸¬è©¦å¤±æ•—\"\nelse\n  echo\
        \ \"â„¹ï¸ æœªç™¼ç¾æ¸¬è©¦æ–‡ä»¶\"\nfi\n"
    - if: always()
      name: ç”Ÿæˆæ¸¬è©¦å ±å‘Š
      run: "echo \"# \U0001F9EA Unit Test Report\" > test-report.md\necho \"\" >>\
        \ test-report.md\necho \"**æ¸¬è©¦æ™‚é–“**: $(date)\" >> test-report.md\necho \"**Python\
        \ ç‰ˆæœ¬**: ${{ matrix.python-version }}\" >> test-report.md\necho \"**æäº¤**: ${{\
        \ github.sha }}\" >> test-report.md\necho \"\" >> test-report.md\n\nif [ -f\
        \ \"test-results.xml\" ]; then\n  echo \"## \U0001F4CA æ¸¬è©¦çµ±è¨ˆ\" >> test-report.md\n\
        \  # è§£æ JUnit XML çµ±è¨ˆä¿¡æ¯\n  TESTS=$(grep -o 'tests=\"[0-9]*\"' test-results.xml\
        \ | head -1 | cut -d'\"' -f2 || echo \"0\")\n  FAILURES=$(grep -o 'failures=\"\
        [0-9]*\"' test-results.xml | head -1 | cut -d'\"' -f2 || echo \"0\")\n  ERRORS=$(grep\
        \ -o 'errors=\"[0-9]*\"' test-results.xml | head -1 | cut -d'\"' -f2 || echo\
        \ \"0\")\n  \n  echo \"- ç¸½æ¸¬è©¦æ•¸: $TESTS\" >> test-report.md\n  echo \"- å¤±æ•—æ•¸:\
        \ $FAILURES\" >> test-report.md\n  echo \"- éŒ¯èª¤æ•¸: $ERRORS\" >> test-report.md\n\
        \  \n  if [ \"$FAILURES\" = \"0\" ] && [ \"$ERRORS\" = \"0\" ]; then\n   \
        \ echo \"- ç‹€æ…‹: âœ… å…¨éƒ¨é€šé\" >> test-report.md\n  else\n    echo \"- ç‹€æ…‹: âŒ éƒ¨åˆ†å¤±æ•—\"\
        \ >> test-report.md\n  fi\nelse\n  echo \"â„¹ï¸ æœªç”Ÿæˆæ¸¬è©¦çµæœæ–‡ä»¶\" >> test-report.md\n\
        fi\n\ncat test-report.md\n"
    - if: always()
      name: ä¸Šå‚³æ¸¬è©¦å ±å‘Š
      uses: actions/upload-artifact@v4
      with:
        name: test-results-${{ matrix.python-version }}
        path: 'test-report.md

          test-results.xml

          htmlcov/

          coverage.xml

          '
        retention-days: 30
    strategy:
      matrix:
        python-version:
        - '3.9'
        - '3.11'
        - '3.12'
    timeout-minutes: 30
